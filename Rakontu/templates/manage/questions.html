<html>
	{% include "../common_head.html" %}
	<body>
	{% include "../common_menus.html" %}
	
	{% if current_member.isManagerOrOwner %}
		<div id="stylized" class="rakontu_form">
		<form action="/manage/questions_{{refer_type}}" method="post" enctype="multipart/form-data">
		<h3>Add New {{refer_type|capfirst}} Questions{{"add_new_questions"|tip}}</h3>
		<fieldset>
		<textarea name="newQuestionNames" rows="6" cols="40"></textarea>
		</fieldset>

		{% if questions %}
			<h3>Change {{refer_type|capfirst}} Questions</h3>
			<fieldset>
	      	<table border="1" cellpadding="4" cellspacing="0">
	      	<tr>
	      		<th>Name, question, and explanation</th>
	      		<th>Type</th>
	      		<th>Minimum and maximum<br><i>if value</i></th>
	      		<th>Response<br><i>if boolean</i>{{"response_if_boolean"|info}}</th>
	      		<th>Choices<br><i>if ordinal or nominal</i></i></th>
	      		<th>Multiple answers allowed?<br><i>if ordinal or nominal</i></th>
	      		<th>Inactivate?</th>
	      		</tr>
	      		{% for question in questions %}
	      			<tr>
	      			<td valign="top">Name<div><input type="text" name="name|{{question.key}}" size="20" value="{{question.name}}" maxlength="{{maxlength_name}}"></div>
	      				<br>Question<div><input type="text" name="text|{{question.key}}" size="20" value="{{question.text}}" maxlength="{{maxlength_subject_or_comment}}"></div>
	      				<br>Explanation<div><input type="text" name="help|{{question.key}}" size="20" value="{{question.help}}" maxlength="{{maxlength_subject_or_comment}}"></div></td>
	      			<td valign="top"><div><select name="type|{{question.key}}">
	      				{% for type in question_types %}
	      			 		<option value="{{type}}"
	      			 		{% ifequal type question.type %}
	      			 			selected="selected"
	      			 		{% endifequal %}
	      			 		>{{type}}</option>
	      			 	{% endfor %}
	      			 	</select></div></td>
	      			 <td valign="top" align="center"><div><input type="text" name="minIfValue|{{question.key}}" size="4" value="{{question.minIfValue}}" maxlength="{{maxlength_number}}"></div>
	      			 	<div><input type="text" name="maxIfValue|{{question.key}}" size="4" value="{{question.maxIfValue}}" maxlength="{{maxlength_number}}"></div>
	      			 	</td>
	      			 <td valign="top" align="center"><div><input type="text" name="responseIfBoolean|{{question.key}}" size="10" value="{{question.responseIfBoolean}}" maxlength="{{maxlength_name}}"></div></td>
	      			 <td valign="top" align="center">
	      			 	{% for i in max_num_choices|makeRange %}
	      			 		<input type="text" name="choice{{i}}|{{question.key}}" size="8" value="{{question.choices|listLookup:i|orNothing}}" maxlength="{{maxlength_tag_or_choice}}"><br/>
	      			 	{% endfor %}
	      			 	</td>
	     			 <td valign="top" align="center"><label><input type="checkbox" name="multiple|{{question.key}}" value="multiple|{{question.key}}"
	     			 	{% if question.multiple %}
	     			 		checked="checked"
	     			 	{% endif %}
	     			 	>Multiple</label></div></td>
	      			 <td valign="top" align="center"><input type="checkbox" name="inactivate|{{question.key}}" />Inactivate</td>
	      				</tr>
	      		{% endfor %}
	      	</table>
	      	</fieldset>
	      	
	    {% endif %}
	    
	    <h3>Import/Export</h3>
	    <fieldset>
	    <p>Choose a CSV file to import questions from:
	    <input type="file" name="import" size="40" accept="csv"/></p>
	    {% if questions %}
	    	<p><a href="/manage/questionsToCSV?{{refer_type}}">Export questions to CSV</a></p>
	    {% endif %}
	    </fieldset>
	      	
		{% if inactive_questions %}
			<h3>Inactive questions{{"inactive_questions"|caution}}</h3>
			<ul>
			{% for question in inactive_questions %}
				<li class="nobullet">{{question.name}}</li>
			{% endfor %}
			</ul>
		{% endif %}

	    {% if system_questions %}
			<h3>Copy {{refer_type|capfirst}} Questions from Samples{{"copy_sample_questions"|tip}}</h3>
			<fieldset>
	      	<table border="1" cellpadding="4" cellspacing="0">
	      	<tr>
	      		<th>Copy?</th>
	      		<th>Question</th>
	      		</tr>
				{% for sys_question in system_questions %}
	      			<td valign="top" width="80"><input type="checkbox" name="copy|{{sys_question.key}}" value="copy|{{sys_question.key}}" id="copy|{{sys_question.key}}">
	      			<label for="copy|{{sys_question.key}}">Copy</label></td>
					<td valign="top">
					The question "{{sys_question.name}}" asks "<b>{{sys_question.text}}</b>"
					It is a{% ifequal sys_question.type "ordinal" %}n{% endifequal %} <b>{{sys_question.type}}</b> question.
					{% ifequal sys_question.type "value" %} 
						Allowed values are between {{sys_question.minIfValue}} and {{sys_question.maxIfValue}}. 
					{% endifequal %}
					{% ifequal sys_question.type "boolean" %} 
						Positive answers are given as "{{sys_question.responseIfBoolean}}." 
					{% endifequal %}
					{% ifequal sys_question.type "ordinal" %}
						Choices are:
						<ol>
						{% for choice in sys_question.choices %}
							<li>{{choice}}</li>
						{% endfor %}
						</ol>
					{% endifequal %}
					{% ifequal sys_question.type "nominal" %}
						Choices are:
						<ul>
						{% for choice in sys_question.choices %}
							<li>{{choice}}</li>
						{% endfor %}
						</ul>
					{% endifequal %}
					{% if sys_question.multiple %} Multiple answers are allowed. {% endif %}
					{% if sys_question.help %} The explanation given is "{{sys_question.help}}" {% endif %}
					</td>
					</tr>
				{% endfor %}
				</table>
				</fieldset>
			{% endif %}

		<p>
    <center><input type="submit" name="changesTo|{{refer_type}}" value="Change Questions About {{refer_type_plural|capfirst}}" class="button"/></center>
	</form>	
	</div>
	{% else %}
		<p>You are not a manager of this community and cannot change its questions.
		Please ask a manager to make any changes you would like to see made.</p>
	{% endif %}

	</div>
	{% include "../common_footer.html" %}
	</body>
</html>
