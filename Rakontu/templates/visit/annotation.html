<html>
	<head>
		<link type="text/css" rel="stylesheet" href="/stylesheets/base.css" />
	</head>
	<body>
		{% include "../menus.html" %}
		<div id="content">
		
		<form action="/visit/annotation
		{% if annotation %}
		?{{annotation.key}}
		{% endif %}
		" method="post" enctype="multipart/form-data">
		
			<h3>{{annotation_type|capfirst}}</h3>
			<fieldset>
			
	type = db.StringProperty(choices=ANNOTATION_TYPES)
	
	shortString = db.StringProperty(default="Untitled")
	longString = db.TextProperty()
	typeIfRequest = db.StringProperty(choices=REQUEST_TYPES, required=True)
	valueIfNudge = db.IntegerProperty(default=0)

	collectedOffline = db.BooleanProperty(default=False)
	liaison = db.ReferenceProperty(Member, default=None, collection_name="annotations_liaisoned")
	attribution = db.StringProperty(choices=ATTRIBUTION_CHOICES, default="member")
	personification = db.ReferenceProperty(Personification, default=None)


			
			
			
			{% if annotation %}
				You can change the text of your {{annotation_type}} here.
			{% else %}
				Please type your {{article_type}} here.
			{% endif %}
			<div><textarea name="text" rows="20" cols="60">{% if article %}{{article.text}}{% endif %}</textarea></div>
			
			{% if article %}
				You can change the name of your {{article_type}} here.
			{% else %}
				Please give your {{article_type}} a name.
			{% endif %}
			<div><input type="text" name="title" size="60" value="{% if article %}{{article.title}}{% endif %}"/></div>
			
			{% if current_member.isLiaison %}
				<div><label><input type="checkbox" name="collectedOffline" value="yes" checked>This {{article_type}} was collected offline.</label></div>
				{% if article %}
					<p>This off-line {{article_type}} was collected from:</p>
				{% else %}
					<p>If this {{article_type}} was collected off-line, please choose a member to assign it to.</p>
				{% endif %}
				<select name="offlineSource">
					{% for member in community_members %}
						<option value="{{member.key}}">{{member.nickname}}
						{% if article %}
							{% ifequal member.key article.creator.key %}
								selected="selected"
							{% endifequal %}
						{% endif %}
						</option>
					{% endfor %}
				</select>
			{% endif %}
			
			{% if show_attribution_choice %}
				{% if article %}
					<p>You can change who this {{article_type}} is attributed to here.</p>
				{% else %}
					<p>To whom would you like to attribute this {{article_type}}?</p>
				{% endif %}
				
				<select name="attribution">
					<option value="member"
						{% if article %}
							{% ifequal article.attribution "member" %}
								selected="selected"
							{% endifequal %}
						{% endif %}
						>Me ({{current_member.nickname}})</option>
					{% if anon_entry_allowed %}
						<option value="anonymous"
						{% if article %}
							{% ifequal article.attribution "anonymous" %}
								selected="selected"
							{% endifequal %}
						{% endif %}
						>Anonymous</option>
					{% endif %}
					{% if community.getPersonifications %}
						{% for personification in community.getPersonifications %}
							<option value="{{personification.key}}"
							{% if article %}
								{% ifequal article.personification.key personification.key %}
									selected="selected"
								{% endifequal %}
							{% endif %}
							>{{personification.name}}</option>
						{% endfor %}
					{% endif %}
				</select>
			{% endif %}
			</fieldset>
			
			<p>
			{% if questions %}
				{% include "questions.html" %}
			{% endif %}
			
			<h3>Attachments</h3>
			<fieldset>
			{% if article %}
				<p>This {{article_type}} has these attachments.
			{% else %}
				<p>You can attach some files to this {{article_type}} here.
			{% endif %}
			<i>You can attach up to three files (PDF, TXT, DOC, JPG, PNG only). No uploaded file can be larger
			than 10 megabytes.</i></p>
			<h4>First attachment</h4>
			<p>Name</p>
			<div><input type="text" name="attachmentName0" value="{{attachments.0.name}}"/></div></p>
			{% if article %}
				{% if attachments.0.fileName %}
				<p><b>File</b>: <a href="attachment?attachment_id={{attachments.0.key}}">{{attachments.0.fileName}}</a>
				&nbsp; <label><input type="checkbox" name"removeAttachment|{{attachments.0.key}}" value="removeAttachment|{{attachments.0.key}}">Remove</label></p>
				{% else %}
				<p><b>File</b>: none</p>
				{% endif %}
				<p>Click Browse to replace the first attachment for this {{article_type}}.</p>
			{% else %}
				<p>Click Browse to choose a first attachment for this {{article_type}}.</p>
			{% endif %}
			<p><input type="file" name="attachment0"/></p>

			<h4>Second attachment</h4>
			<p>Name</p>
			<div><input type="text" name="attachmentName1" value="{{attachments.1.name}}"/></div></p>
			{% if article %}
				{% if attachments.1.fileName %}
				<p><b>File</b>: <a href="attachment?attachment_id={{attachments.1.key}}">{{attachments.1.fileName}}</a>
				&nbsp; <label><input type="checkbox" name"removeAttachment|{{attachments.1.key}}" value="removeAttachment|{{attachments.1.key}}">Remove</label></p>
				{% else %}
				<p><b>File</b>: none</p>
				{% endif %}
				<p>Click Browse to replace the second attachment for this {{article_type}}.</p>
			{% else %}
				<p>Click Browse to choose a second attachment for this {{article_type}}.</p>
			{% endif %}
			<p><input type="file" name="attachment1"/></p>
			
			
			<h4>Third attachment</h4>
			<p>Name</p>
			<div><input type="text" name="attachmentName2" value="{{attachments.2.name}}"/></div></p>
			{% if article %}
				{% if attachments.2.fileName %}
				<p><b>File</b>: <a href="attachment?attachment_id={{attachments.2.key}}">{{attachments.2.fileName}}</a>
				&nbsp; <label><input type="checkbox" name"removeAttachment|{{attachments.2.key}}" value="removeAttachment|{{attachments.2.key}}">Remove</label></p>
				{% else %}
				<p><b>File</b>: none</p>
				{% endif %}
				<p>Click Browse to replace the third attachment for this {{article_type}}.</p>
			{% else %}
				<p>Click Browse to choose a third attachment for this {{article_type}}.</p>
			{% endif %}
			<p><input type="file" name="attachment2"/></p>
			</fieldset>
			
			<p>
			<center>
			{% if article %}
				<input type="submit" name="change|{{article_type}}|{{article.key}}" value="Change {{article_type|capfirst}}">
				<input type="submit" name="remove|{{article_type}}|{{article.key}}" value="PERMANENTLY REMOVE this {{article_type|capfirst}}"
					onClick="javascript:return confirm('Are you sure you want to delete this item?')"">
			{% else %}
				<input type="submit" name="add|{{article_type}}" value="Add {{article_type|capfirst}}">
			{% endif %}
			</center>
			
		</form>
		</div>
	</body>
</html>
